# カスタムキーボード

8キー + ロータリーエンコーダー付きの自作キーボードプロジェクトです。OLEDディスプレイを搭載し、メディア情報の表示やカスタムキーマッピングが可能です。

## 特徴

- **8つのカスタマイズ可能なキー**
- **ロータリーエンコーダー** による音量調整やメディアコントロール
- **128x64 OLEDディスプレイ** による楽曲情報表示
- **リアルタイム楽曲情報表示** - 現在再生中の楽曲名、再生状態、進行状況
- **カスタムキーマッピング** - キーボード入力、メディアキー、特殊コマンドに対応
- **日本語入力サポート** - MeCab辞書を使用した日本語変換機能

## 構成

### ハードウェア
- Arduino互換マイコンボード
- 8個のタクトスイッチ
- ロータリーエンコーダー（プッシュスイッチ付き）
- SSD1306 OLEDディスプレイ (128x64)
- I2C通信

### ソフトウェア構成

#### 1. ファームウェア (`firmware/`)

**主な機能:**
- キー入力とロータリーエンコーダーの処理
- OLEDディスプレイによる情報表示
- シリアル通信によるPC側アプリとの連携
- EEPROM設定保存

#### 2. 設定アプリケーション (`client/`)
Windows用のWPF設定アプリケーションです。

**主な機能:**
- キーマッピングの設定と管理
- メディア情報の取得と送信
- 日本語入力変換機能
- シリアル通信によるファームウェアとの連携

## セットアップ

### 必要な環境
- **ファームウェア開発:** Arduino IDE または PlatformIO
- **設定アプリ:** .NET 9.0 + Windows 10/11

### ファームウェアのビルドとアップロード
1. Arduino IDEでライブラリをインストール:
   - U8g2lib (OLEDディスプレイ用)
   - HID-Project (HID機能用)
2. `firmware/main.cpp`をArduino IDEで開く
3. 適切なボードとポートを選択
4. コンパイル・アップロード

### 設定アプリのビルド
```bash
cd client
dotnet build
dotnet run
```

## 使用方法

### キーマッピング設定
1. 設定アプリを起動
2. シリアルポートに接続
3. 各キーに機能を割り当て:
   - **キーボード入力** - 通常のキーやキーコンビネーション
   - **メディアキー** - 音量調整、再生/停止など
   - **コマンド** - アプリケーション起動など
4. 設定を保存

### ロータリーエンコーダー
- **回転:** 音量調整やトラック選択
- **プッシュ:** 再生/停止
- **プッシュ+回転:** 別機能の実行

### ディスプレイ表示
- 現在再生中の楽曲名（長い場合はスクロール表示）
- 再生状態（再生/停止アイコン）
- 進行状況バー
- メディアコントロールアイコン

## 通信プロトコル

ファームウェアとPCアプリ間はシリアル通信で連携します。

**主なコマンド:**
- `GET_CONFIG` - 現在の設定取得
- `SET_CONFIG:` - 設定の更新
- `SONG_INFO:` - 楽曲情報の更新
- `GET_STATS` - メモリ使用状況取得

## ライセンス

このプロジェクトに含まれる日本語辞書は、以下のライセンスに従います：
- MeCab IPAdic
